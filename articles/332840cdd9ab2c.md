---
title: "Lravelã«Dockerã§å…¥é–€ã—ã¦ã¿ã‚‹"
emoji: "â›³"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: [Laravel, Docker]
published: true
---

# ã¯ã˜ã‚ã«
ã“ã‚“ã«ã¡ã¯ã€ãŠãã‚‰ãçŠ¬ã§ã™ã€‚

å‹‰å¼·ã®ãŸã‚ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã«ä½¿ã‚ã‚Œã¦ã„ã‚‹ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ç­‰ã‚’è§¦ã£ã¦ã„ã“ã†ã¨æ€ã„ã¾ã™ã€‚
ä»Šå›ã¯æœ‰åãªPHPã®ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã®**Laravl**ã‚’è§¦ã£ã¦ã„ããŸã„ã¨æ€ã„ã¾ã™ã€‚

ã¡ãªã¿ã«ç­†è€…ã¯PHPæœªçµŒé¨“ã€Docker1å¹´ãã‚‰ã„ã®æ¸©åº¦æ„Ÿã§ã™ã€‚

ã¾ãšã¯ç’°å¢ƒæ§‹ç¯‰ã‹ã‚‰ã—ã¦ã„ãã¾ã™ã€‚
ã¡ãªã¿ã«ã“ã®è¨˜äº‹ã®å…¬é–‹æ™‚ã®Laravelã¯10ç³»ã§ã™ã€‚

# æƒ³å®šèª­è€…
- Dockerã«ã¤ã„ã¦åŸºæœ¬çš„ãªçŸ¥è­˜ãŒã‚ã‚‹
- Laravelã‚„PHPã«ã¤ã„ã¦ã¯çŸ¥è­˜ãŒãªã„

# ç’°å¢ƒæ§‹ç¯‰
ã¾ãšåˆã‚ã«[å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://laravel.com/docs/10.x)ã‚’èª­ã¿ã¾ã™ã€‚

ãã“ã§ç›®ã«å…¥ã£ã¦ãã‚‹Laravel & Docker...ğŸ‘€

PHPç­‰ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã¯é¢å€’ãªã®ã§Dockerã§æ¸ˆã¾ã›ã‚‹ã“ã¨ã«ã—ã¾ã™ã€‚Dockerã®å°å…¥æ–¹æ³•ã¯å‰²æ„›ã—ã¾ã™ã€‚

ç­†è€…ã¯WSLã§é–‹ç™ºã—ã¦ã„ã‚‹ã®ã§ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’ãŸãŸãã¾ã—ãŸã€‚å¿…è¦ãªã‚·ã‚§ãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œã—ã¦ãã‚Œã¾ã™ã€‚

```bash
curl -s https://laravel.build/hello-laravel | bash
```

ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ä¸­ã«æš‡ãªã®ã§ã‚·ã‚§ãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®ä¸­èº«ã‚’è¦‹ã¦ã¿ã¾ã™ã€‚

```bash
docker info > /dev/null 2>&1

# Ensure that Docker is running...
if [ $? -ne 0 ]; then
    echo "Docker is not running."

    exit 1
fi

docker run --rm \
    --pull=always \
    -v "$(pwd)":/opt \
    -w /opt \
    laravelsail/php82-composer:latest \
    bash -c "laravel new hello-laravel && cd hello-laravel && php ./artisan sail:install --with=mysql,redis,meilisearch,mailpit,selenium "

cd hello-laravel

# Allow build with no additional services..
if [ "mysql redis meilisearch mailpit selenium" == "none" ]; then
    ./vendor/bin/sail build
else
    ./vendor/bin/sail pull mysql redis meilisearch mailpit selenium
    ./vendor/bin/sail build
fi

CYAN='\033[0;36m'
LIGHT_CYAN='\033[1;36m'
BOLD='\033[1m'
NC='\033[0m'

echo ""

if sudo -n true 2>/dev/null; then
    sudo chown -R $USER: .
    echo -e "${BOLD}Get started with:${NC} cd hello-laravel && ./vendor/bin/sail up"
else
    echo -e "${BOLD}Please provide your password so we can make some final adjustments to your application's permissions.${NC}"
    echo ""
    sudo chown -R $USER: .
    echo ""
    echo -e "${BOLD}Thank you! We hope you build something incredible. Dive in with:${NC} cd hello-laravel && ./vendor/bin/sail up"
fi
```

`laravelsail/php82-composer:latest`ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ä½¿ã£ã¦Laravelç’°å¢ƒã‚’æ§‹ç¯‰ã—ã¦ã„ã‚‹ã£ã½ã„ã§ã™ã€‚
åŒæ™‚ã«mysql, redis, meilisearch, mailpit, seleniumã®ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚‚åˆ©ç”¨ã—ã¦ãŠã‚Šã€ä¸€é€šã‚Šé–‹ç™ºã«å¿…è¦ãªãƒ¢ãƒã¯ãã‚ã£ã¦ã„ã‚‹ã‚ˆã†ã§ã™ã€‚
ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œå¾Œã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã£ã¦ã„ã¾ã™ã€‚

![ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆ](/images/332840cdd9ab2c/2023-09-23-14-47-58.png)

`.env`ã‚„`.gitignore`, `docker-compose.yml`ç­‰ãŒã™ã§ã«æ•´ã£ã¦ãŠã‚Šã€ã™ã§ã«é–‹ç™ºã«å¿…è¦ãªã‚‚ã‚ã‚‚ã‚ã¯ç”¨æ„ã•ã‚Œã¦ã„ã‚‹ã¨ã„ã£ãŸå…·åˆã§ã™ã€‚
ã‚ã£ã¡ã‚ƒæ¥½ï½ã€‚

# ã„ã–èµ·å‹•
ç’°å¢ƒæ§‹ç¯‰ã¯æ•´ã£ãŸã®ã§å…¬å¼ã®æŒ‡ç¤ºé€šã‚Š`./vendor/bin/sail up`ã§èµ·å‹•ã—ã¾ã™ã€‚
æ™®é€šã¯`docker compose up`ã§ã™ãŒã€Laravelã§ã¯ã“ã®èµ·å‹•æ–¹æ³•ã§ã‚‚å¯èƒ½ãªã‚ˆã†ã§ã™ã€‚
sailã¯Laravel Sailã¨ã„ã†ã‚‚ã®ã®ã‚³ãƒãƒ³ãƒ‰ã®ã‚ˆã†ã§ã€Laravel Sailã¯Dockerã‚’ã‚ã¾ã‚ŠçŸ¥ã‚‰ãªãã¦ã‚‚ä½¿ãˆã‚‹ã‚ˆã†ã«ã—ã¦ãã‚Œã‚‹è»½é‡ãªCLIã ãã†ã§ã™ã€‚

[Laravel Sail](https://laravel.com/docs/10.x/sail)
>  Laravel Sail is a light-weight command-line interface for interacting with Laravel's default Docker development environment. Sail provides a great starting point for building a Laravel application using PHP, MySQL, and Redis without requiring prior Docker experience.

ã‚¨ã‚³ã‚·ã‚¹ãƒ†ãƒ æ•´ã£ã¦ã‚“ãªãï½ã€‚

è±†çŸ¥è­˜ã¯ã“ã‚Œãã‚‰ã„ã«ã—ã¦èµ·å‹•ã—ã¾ã™ã€‚

```
$ ./vendor/bin/sail up
~~~ç•¥~~~
Error response from daemon: Ports are not available: exposing port TCP 0.0.0.0:80 -> 0.0.0.0:0: listen tcp 0.0.0.0:80: bind: An attempt was made to access a socket in a way forbidden by its access permissions.
```

ãªã‚“ã‹80ç•ªãƒãƒ¼ãƒˆã‚’å–ã‚ã†ã¨ã™ã‚‹ã¨æ€’ã‚‰ã‚ŒãŒç™ºç”Ÿã—ãŸã®ã§ä»–ã®ãƒãƒ¼ãƒˆã‚’å½“ãŸã‚Šã¾ã™ã€‚
`docker-compose.yml`ã‚’è¦‹ã‚‹ã¨`${APP_PORT}`ã‚’æŒ‡å®šã—ã¦ãªã„å ´åˆã«ã¯ãƒ›ã‚¹ãƒˆã®80ç•ªã‚’å–ã‚ã†ã¨ã™ã‚‹ã£ã½ã„ã®ã§`.env`ãƒ•ã‚¡ã‚¤ãƒ«ã«`APP_PORT=8080`ã‚’è¿½åŠ ã—ã¾ã™ã€‚

```docker-compose.yml
services:
    laravel.test:
        ~~~ç•¥~~~
        ports:
            - '${APP_PORT:-80}:80'
            - '${VITE_PORT:-5173}:${VITE_PORT:-5173}'
```

```.env
APP_NAME=Laravel
APP_ENV=local
APP_KEY=base64:38bVt2x2DicVaZMmZxWoR+a7s+yzm+Ad2vQP00aqivA=
APP_DEBUG=true
APP_URL=http://localhost
APP_PORT=8080 # <- è¿½è¨˜
```

å¤‰æ›´å¾Œå†åº¦`./vendor/bin/sail up`ã—ã¾ã™ã€‚

```sh
hello-laravel-laravel.test-1  | 2023-09-23 06:22:19,610 INFO spawned: 'php' with pid 16
hello-laravel-laravel.test-1  | 2023-09-23 06:22:20,612 INFO success: php entered RUNNING state, process has stayed up for > than 1 seconds (startsecs)
hello-laravel-laravel.test-1  | 
hello-laravel-laravel.test-1  |    INFO  Server running on [http://0.0.0.0:80].  
hello-laravel-laravel.test-1  | 
hello-laravel-laravel.test-1  |   Press Ctrl+C to stop the server
hello-laravel-laravel.test-1  | 
```

ãƒ¨ã‚·ï¼

http://localhost:8080 ã«æ¥ç¶šã—ã¦ã¿ã¾ã™ã€‚

![Laravel](/images/332840cdd9ab2c/2023-09-23-15-43-11.png)

ç„¡äº‹è¡¨ç¤ºã•ã‚Œã¾ã—ãŸã€‚ã“ã‚Œã§é–‹ç™ºç’°å¢ƒãŒæ•´ã„ã¾ã—ãŸã€‚

# ãŠã‚ã‚Šã«
Laravelã¯éå¸¸ã«ã‚¨ã‚³ã‚·ã‚¹ãƒ†ãƒ ãŒæ•´ã£ã¦ã„ã‚‹ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã ã¨ã„ã†ã®ã‚’å¼·ã„åŒåƒšã‹ã‚‰èã„ãŸã®ã§ã€ã©ã‚“ãªã‚‚ã‚“ã‹ã¨è©¦ã—ã¦ã¿ã‚ˆã†ã¨æ€ã„ç’°å¢ƒæ§‹ç¯‰ã—ã¦ã¿ã¾ã—ãŸã€‚
ãƒ‡ãƒ—ãƒ­ã‚¤ç­‰ã‚‚å«ã‚ã¦ä»Šå¾Œã„ã‚ã„ã‚ã‚„ã£ã¦ã¿ã¾ã™ã€‚
